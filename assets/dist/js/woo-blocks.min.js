if(window.wc&&window.wc.wcBlocksRegistry&&window.React&&window.wc_reepay){const e=new URL(document.currentScript.src).searchParams.get("name");if(!e)throw"Script "+document.currentScript.src+" - name is undefined";const{registerPaymentMethod:t}=wc.wcBlocksRegistry,{createElement:n,useEffect:a,useState:o,Fragment:s}=React,{useSelect:c,useDispatch:i}=wp.data,{__:r}=wp.i18n,{getSetting:l}=wc.wcSettings,{PAYMENT_STORE_KEY:d}=wc.wcBlocksData,{decodeEntities:p}=wp.htmlEntities,u=l(e+"_data",{}),y=p(u.title)||r("Reepay checkout","reepay-checkout-gateway");u.tokens&&u.tokens.push({id:"new"});const m=n((()=>{const[e,t]=o(0),a=u.tokens.map((a=>n(h,{token:a,activeToken:e,setActiveToken:t})));return n("ul",{className:"reepay-blocks-list"},...a,"new"===e?n("li",null,n(w)):null)})),h=({token:t,activeToken:a,setActiveToken:o})=>{const{paymentMethodData:s}=c((e=>({paymentMethodData:e(d).getPaymentMethodData()}))),{__internalSetPaymentMethodData:l}=i(d),p=`wc-${e}-payment-token`,u=t.image?n("img",{src:t.image,image_alt:t.label}):null,y=n("input",{type:"radio",name:p,id:`${p}-${t.id}`,value:t.id,checked:a===t.id,onChange:()=>{s[p]!==t.id&&(l({...s,[p]:""+t.id}),o(t.id))}}),m=n("label",{htmlFor:`wc-${e}-payment-token-${t.id}`},u,"new"===t.id?r("Use a new payment method","reepay-checkout-gateway"):`${t.masked} ${t.expiry_month}/${t.expiry_year}`);return n("li",{key:t.id,className:"reepay-blocks-list-item"},y,m)},w=()=>{const[t,a]=o(u.always_save_token||!1),{paymentMethodData:l}=c((e=>({paymentMethodData:e(d).getPaymentMethodData()}))),{__internalSetPaymentMethodData:p}=i(d),y=`wc-${e}-new-payment-method`,m=n("input",{type:"checkbox",name:y,id:y,value:!0,checked:t,disabled:u.always_save_token||!1,onChange:u.always_save_token?void 0:e=>{if(e.target.checked)p({...l,[y]:"true"});else{const e={...l};delete e[y],p(e)}a(!t)}}),h=n("label",{htmlFor:y},r("Save to account","reepay-checkout-gateway"));return n(s,{},m,h)},k=n((e=>{const{eventRegistration:t,emitResponse:n}=e,{onPaymentProcessing:o,onCheckoutAfterProcessingWithSuccess:s,onCheckoutAfterProcessingWithError:c}=t;return a((()=>{const e=o((async e=>{console.log("onPaymentProcessing",e)})),t=s((async e=>{console.log("onCheckoutAfterProcessingWithSuccess",e);const{processingResponse:t}=e,{paymentDetails:n}=t;n.reepay_id&&n.accept_url&&wc_reepay.buildModalCheckout(n.reepay_id,n.accept_url)})),n=c((async e=>{console.log("onCheckoutAfterProcessingWithSuccess",e)}));return()=>{e(),t(),n()}}),[n.responseTypes.SUCCESS,n.responseTypes.ERROR,n.responseTypes.FAIL]),u.tokens?m:p(u.description||"")}),null),g=n((e=>{const{PaymentMethodLabel:t}=e.components;return n(t,{text:y})}),null);t({name:e,label:g,content:k,edit:k,savedTokenComponent:null,canMakePayment:()=>!0,ariaLabel:y,supports:{features:Object.values(u.supports??{})}})}